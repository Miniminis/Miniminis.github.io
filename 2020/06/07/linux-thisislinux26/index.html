<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head><meta name="generator" content="Hexo 3.9.0">

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="‘이것이 리눅스다 2020년 개정판’을 공부하고 있다. 나와 같이 블로그나 글을 통해 공부하는 것이 더 편한 사람들을 위해 공부의 과정을 간단하게나마 글로 남기고자 한다. 책은 [링크]를 통해 구입할 수 있고, 강의는 [링크]에서 확인할 수 있다. 한빛에서 네이버 카페">
    

    <!--Author-->
    
        <meta name="author" content="Kabarnet">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="이것이 리눅스다(2020) 26 / 네임 서버 - IP획득과정, DNS개념, 캐싱전용네임서버 구축">
    

    <!--Open Graph Description-->
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="Kabarnet&#39;s Devlog">

    <!--Type page-->
    
        <meta property="og:type" content="article">
    

    <!--Page Cover-->
    

    <meta name="twitter:card" content="summary">
    

    <!-- Title -->
    
    <title>이것이 리눅스다(2020) 26 / 네임 서버 - IP획득과정, DNS개념, 캐싱전용네임서버 구축 - Kabarnet&#39;s Devlog</title>

    <!-- Tachyons Core CSS -->
    <link rel="stylesheet" href="https://unpkg.com/tachyons/css/tachyons.min.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Google Analytics -->
    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-149033629-1', 'auto');
        ga('send', 'pageview');

    </script>



</head>


<body>

<!-- Main Content -->
<!-- Banner -->
<!-- Banner -->
<div class="w-100 bg-1 ph5-ns ph3 text-light">
    
    <nav class="db dt-l w-100 mw8 center border-box pv3">
        <a class="db dtc-l v-mid link dim w-100 w-25-l tc tl-l mb2 mb0-l white" href="/" title="Kabarnet's Devlog">
            <img src="http://www.codeblocq.com/assets/projects/hexo-theme-anodyne/assets/anodyne.svg" class="dib h3" alt="Kabarnet's Devlog">
        </a>
        <div class="db dtc-l v-mid w-100 w-75-l tc tr-l">
            
                <a class="link dim f6 f5-l dib mr3 mr4-l white" 
                    href="/" 
                    title="Home">
                    Home
                </a>
            
                <a class="link dim f6 f5-l dib mr3 mr4-l white" 
                    href="/tags" 
                    title="Tags">
                    Tags
                </a>
            
                <a class="link dim f6 f5-l dib mr3 mr4-l white" 
                    href="/projects" 
                    title="Projects">
                    Projects
                </a>
            
                <a class="link dim f6 f5-l dib mr3 mr4-l white" 
                    href="/about.html" 
                    title="About">
                    About
                </a>
            
        </div>
    </nav>

    <!-- Title -->
    <div class="w-100 mw8 center vh-40 dt">
        <div class="dtc v-mid white">
            <h1 class="f1-l f2-m tc tc-m tl-ns">이것이 리눅스다(2020) 26 / 네임 서버 - IP획득과정, DNS개념, 캐싱전용네임서버 구축</h1>
            <p class="f4 fw3 pab-100px tc tc-m tl-ns">2020-06-07</p>
        </div>
    </div>

    <!-- Icon -->
    <div class="relative w-100 mw8 center white dn dn-m db-ns">
        <i class="header-icon fa fa-file-text-o"></i>
    </div>
</div>

<!-- Content -->
<div class="w-100 ph2 ph4-m ph5-l mv5 mv6-l">
    <div class="content">
        <div class="mw8 center">
            <div class="cf">
                <div class="fl w-100 w-70-l mw7 left fw3 lh-copy pr4-ns pr0-m post-content">
                    <!-- Tags Vertical -->
                    
                        <div class="tags-container-vertical">
                            <div class="tags-sub-container">
                                <a class="fw3 ph1 dib" href="/tags/linux/">#linux</a>
                            </div>
                        </div>
                    

                    <!-- Main Post Content -->
                    <p>‘이것이 리눅스다 2020년 개정판’을 공부하고 있다. 나와 같이 블로그나 글을 통해 공부하는 것이 더 편한 사람들을 위해 공부의 과정을 간단하게나마 글로 남기고자 한다. 책은 <a href="https://www.hanbit.co.kr/store/books/look.php?p_code=B8529915277" target="_blank" rel="noopener">[링크]</a>를 통해 구입할 수 있고, 강의는 <a href="https://www.youtube.com/playlist?list=PLVsNizTWUw7EJ9z-LW3lv3VC-6HI9I3hN" target="_blank" rel="noopener">[링크]</a>에서 확인할 수 있다. 한빛에서 네이버 카페<a href="https://cafe.naver.com/thisislinux" target="_blank" rel="noopener">[링크]</a>도 운영하고 있어서 정말 편하게 공부하고 있다. (열심히 공부해서 성공하겠습니다…! 감사합니다…!)<br><br><br></p>
<h2 id="IP획득과정"><a href="#IP획득과정" class="headerlink" title="IP획득과정"></a>IP획득과정</h2><ol>
<li>사용자가 URL 입력</li>
<li>/etc/host.conf 조회 (순서 : hosts, bind)</li>
<li>/etc/hosts.conf 조회<ol>
<li>있음 &gt; ip주소 획득!</li>
<li>없음 &gt; 4번</li>
</ol>
</li>
<li>/etc/resolv.conf 조회 <ol>
<li>네임서버설정 없음 &gt;&gt; 호스트 이름을 알 수 없습니다 &gt; 종료  </li>
<li>네임서버설정 있음 &gt;&gt; 질의<ol>
<li>응답 &gt;&gt; ip 주소 반환</li>
<li>응답없음 &gt;&gt; 호스트 이름을 알 수 없습니다.</li>
</ol>
</li>
</ol>
</li>
</ol>
<br>
정리하자면, hosts 내부 파일을 먼저 뒤지고 없으면 >> 네임서버로 이동해서 질의한다.

<p><br><br></p>
<h2 id="DNS개념"><a href="#DNS개념" class="headerlink" title="DNS개념"></a>DNS개념</h2><ul>
<li>초창기 인터넷에서는 네임서버 1대 만으로도 충분히 ip주소와 이름을 관리할 수 있었다.</li>
<li>하지만 그 수가 기하급수적으로 많아지면서 보다 효율적인 관리를 위해 트리구조의 도메인 이름 체계를 구축하게 되었음</li>
<li>예시) <ul>
<li>.(root)<ul>
<li>net</li>
<li>com<ul>
<li>nate<ul>
<li>www</li>
<li>ftp</li>
<li>mail</li>
</ul>
</li>
<li>google</li>
<li>naver</li>
</ul>
</li>
<li>org</li>
<li>edu</li>
<li>kr<ul>
<li>co<ul>
<li>samsung<ul>
<li>www</li>
<li>ftp</li>
<li>mail</li>
</ul>
</li>
</ul>
</li>
<li>or</li>
</ul>
</li>
<li>fr</li>
<li>sp</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><br><br></p>
<h2 id="로컬-네임-서버가-작동하는-방식"><a href="#로컬-네임-서버가-작동하는-방식" class="headerlink" title="로컬 네임 서버가 작동하는 방식"></a>로컬 네임 서버가 작동하는 방식</h2><ol>
<li>사용자가 URL을 입력하면, 로컬 네임서버가 자신의 캐시 DB를 뒤진다.</li>
<li>캐시 DB에서 매핑되어있는 ip주소를 찾으면 바로 응답해주면 되지만, 그런 경우는 사실 드물다. 매핑되는 ip주소를 찾지 못한 로컬 네임서버는 root 네임서버에게 해당 url를 질의한다.</li>
<li>하지만 root가 아는 것은 자신의 바로 밑에 있는 com 정도이다. root는 com을 반환한다.</li>
<li>로컬네임서버는 com 네임서버로 가서 다시 url을 질의한다. com은 자기가 아는 nate를 반환해준다.</li>
<li>로컬네임서버는 nate 네임서버로 가서 url을 질의한다. nate는 자신의 캐시DB을 뒤져서 해당 ip주소를 반환해준다.</li>
<li>로컬네임서버는 사용자에게 알맞는 ip주소를 반환해준다. </li>
<li>획득한 ip주소로 사용자는 목적지에 도달한다.</li>
</ol>
<br>

<h3 id="캐싱전용-네임서버와-마스터-네임서버"><a href="#캐싱전용-네임서버와-마스터-네임서버" class="headerlink" title="캐싱전용 네임서버와 마스터 네임서버"></a>캐싱전용 네임서버와 마스터 네임서버</h3><ol>
<li>캐싱전용 네임서버는 PC에서 URL로 IP주소를 얻고자 할 때, 해당하는 URL의 IP주소를 알려주는 네임서버를 의미한다.</li>
<li>마스터 네임서버는 로컬 네임 서버가 외부에 질의했을때 실제 ip주소를 반환해주는 서버를 의미한다.</li>
</ol>
<p><br><br></p>
<h2 id="캐싱전용-네임서버-실제로-구축하기"><a href="#캐싱전용-네임서버-실제로-구축하기" class="headerlink" title="캐싱전용 네임서버 실제로 구축하기"></a>캐싱전용 네임서버 실제로 구축하기</h2><h3 id="이전에-etc-hosts-파일-수정내용-원복"><a href="#이전에-etc-hosts-파일-수정내용-원복" class="headerlink" title="이전에 /etc/hosts 파일 수정내용 원복"></a>이전에 /etc/hosts 파일 수정내용 원복</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@192 ~]# nano /etc/hosts</span><br><span class="line">[root@192 ~]# cat /etc/hosts</span><br><span class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br></pre></td></tr></table></figure>

<h3 id="캐싱서버-구축을-위해서-설치파일-다운로드"><a href="#캐싱서버-구축을-위해서-설치파일-다운로드" class="headerlink" title="캐싱서버 구축을 위해서 설치파일 다운로드"></a>캐싱서버 구축을 위해서 설치파일 다운로드</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">[root@192 ~]# dnf -y install bind-chroot</span><br><span class="line">마지막 메타 데이터 만료 확인 : 3:21:11 전에 2020년 06월 07일 (일) 오후 05시 06분 39초.</span><br><span class="line">종속성이 해결되었습니다.</span><br><span class="line">================================================================================</span><br><span class="line"> 꾸러미             아키텍처   버전                         리포지토리     크기</span><br><span class="line">================================================================================</span><br><span class="line">Installing:</span><br><span class="line"> bind-chroot        x86_64     32:9.11.4-17.P2.el8_0.1      AppStream     100 k</span><br><span class="line">Upgrading:</span><br><span class="line"> bind-libs          x86_64     32:9.11.4-17.P2.el8_0.1      AppStream     169 k</span><br><span class="line"> bind-libs-lite     x86_64     32:9.11.4-17.P2.el8_0.1      AppStream     1.1 M</span><br><span class="line"> bind-license       noarch     32:9.11.4-17.P2.el8_0.1      AppStream      98 k</span><br><span class="line"> bind-utils         x86_64     32:9.11.4-17.P2.el8_0.1      AppStream     433 k</span><br><span class="line"> python3-bind       noarch     32:9.11.4-17.P2.el8_0.1      AppStream     145 k</span><br><span class="line">종속성 설치:</span><br><span class="line"> bind               x86_64     32:9.11.4-17.P2.el8_0.1      AppStream     2.1 M</span><br><span class="line"></span><br><span class="line">거래 요약</span><br><span class="line">================================================================================</span><br><span class="line">설치        2 꾸러미</span><br><span class="line">업그레이드  5 꾸러미</span><br><span class="line"></span><br><span class="line">총 다운로드 크기 : 4.2 M</span><br><span class="line">패키지 다운로드중:</span><br><span class="line">(1/7): bind-chroot-9.11.4-17.P2.el8_0.1.x86_64.  51 kB/s | 100 kB     00:01    </span><br><span class="line">(2/7): bind-libs-9.11.4-17.P2.el8_0.1.x86_64.rp  53 kB/s | 169 kB     00:03    </span><br><span class="line">(3/7): bind-license-9.11.4-17.P2.el8_0.1.noarch 324 kB/s |  98 kB     00:00    </span><br><span class="line">(4/7): bind-utils-9.11.4-17.P2.el8_0.1.x86_64.r 392 kB/s | 433 kB     00:01    </span><br><span class="line">(5/7): python3-bind-9.11.4-17.P2.el8_0.1.noarch 376 kB/s | 145 kB     00:00    </span><br><span class="line">(6/7): bind-libs-lite-9.11.4-17.P2.el8_0.1.x86_ 191 kB/s | 1.1 MB     00:06    </span><br><span class="line">(7/7): bind-9.11.4-17.P2.el8_0.1.x86_64.rpm     229 kB/s | 2.1 MB     00:09    </span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">합계                                            450 kB/s | 4.2 MB     00:09     </span><br><span class="line">트랜잭션 점검 실행 중</span><br><span class="line">트랜잭션 검사가 성공했습니다.</span><br><span class="line">트랜잭션 테스트 실행 중</span><br><span class="line">트랜잭션 테스트가 완료되었습니다.</span><br><span class="line">거래 실행 중</span><br><span class="line">  준비 중입니다  :                                                          1/1 </span><br><span class="line">  Upgrading      : bind-license-32:9.11.4-17.P2.el8_0.1.noarch             1/12 </span><br><span class="line">  Upgrading      : bind-libs-lite-32:9.11.4-17.P2.el8_0.1.x86_64           2/12 </span><br><span class="line">  Upgrading      : bind-libs-32:9.11.4-17.P2.el8_0.1.x86_64                3/12 </span><br><span class="line">  스크립틀릿 실행: bind-32:9.11.4-17.P2.el8_0.1.x86_64                     4/12 </span><br><span class="line">  Installing     : bind-32:9.11.4-17.P2.el8_0.1.x86_64                     4/12 </span><br><span class="line">  스크립틀릿 실행: bind-32:9.11.4-17.P2.el8_0.1.x86_64                     4/12 </span><br><span class="line">  Upgrading      : python3-bind-32:9.11.4-17.P2.el8_0.1.noarch             5/12 </span><br><span class="line">  Upgrading      : bind-utils-32:9.11.4-17.P2.el8_0.1.x86_64               6/12 </span><br><span class="line">  Installing     : bind-chroot-32:9.11.4-17.P2.el8_0.1.x86_64              7/12 </span><br><span class="line">  스크립틀릿 실행: bind-chroot-32:9.11.4-17.P2.el8_0.1.x86_64              7/12 </span><br><span class="line">  정리           : bind-utils-32:9.11.4-16.P2.el8.x86_64                   8/12 </span><br><span class="line">  정리           : python3-bind-32:9.11.4-16.P2.el8.noarch                 9/12 </span><br><span class="line">  정리           : bind-libs-32:9.11.4-16.P2.el8.x86_64                   10/12 </span><br><span class="line">  정리           : bind-libs-lite-32:9.11.4-16.P2.el8.x86_64              11/12 </span><br><span class="line">  정리           : bind-license-32:9.11.4-16.P2.el8.noarch                12/12 </span><br><span class="line">  스크립틀릿 실행: bind-chroot-32:9.11.4-17.P2.el8_0.1.x86_64             12/12 </span><br><span class="line">  스크립틀릿 실행: bind-license-32:9.11.4-16.P2.el8.noarch                12/12 </span><br><span class="line">  확인 중        : bind-32:9.11.4-17.P2.el8_0.1.x86_64                     1/12 </span><br><span class="line">  확인 중        : bind-chroot-32:9.11.4-17.P2.el8_0.1.x86_64              2/12 </span><br><span class="line">  확인 중        : bind-libs-32:9.11.4-17.P2.el8_0.1.x86_64                3/12 </span><br><span class="line">  확인 중        : bind-libs-32:9.11.4-16.P2.el8.x86_64                    4/12 </span><br><span class="line">  확인 중        : bind-libs-lite-32:9.11.4-17.P2.el8_0.1.x86_64           5/12 </span><br><span class="line">  확인 중        : bind-libs-lite-32:9.11.4-16.P2.el8.x86_64               6/12 </span><br><span class="line">  확인 중        : bind-license-32:9.11.4-17.P2.el8_0.1.noarch             7/12 </span><br><span class="line">  확인 중        : bind-license-32:9.11.4-16.P2.el8.noarch                 8/12 </span><br><span class="line">  확인 중        : bind-utils-32:9.11.4-17.P2.el8_0.1.x86_64               9/12 </span><br><span class="line">  확인 중        : bind-utils-32:9.11.4-16.P2.el8.x86_64                  10/12 </span><br><span class="line">  확인 중        : python3-bind-32:9.11.4-17.P2.el8_0.1.noarch            11/12 </span><br><span class="line">  확인 중        : python3-bind-32:9.11.4-16.P2.el8.noarch                12/12 </span><br><span class="line"></span><br><span class="line">업그레이드 됨:</span><br><span class="line">  bind-libs-32:9.11.4-17.P2.el8_0.1.x86_64                                      </span><br><span class="line">  bind-libs-lite-32:9.11.4-17.P2.el8_0.1.x86_64                                 </span><br><span class="line">  bind-license-32:9.11.4-17.P2.el8_0.1.noarch                                   </span><br><span class="line">  bind-utils-32:9.11.4-17.P2.el8_0.1.x86_64                                     </span><br><span class="line">  python3-bind-32:9.11.4-17.P2.el8_0.1.noarch                                   </span><br><span class="line"></span><br><span class="line">설치됨:</span><br><span class="line">  bind-chroot-32:9.11.4-17.P2.el8_0.1.x86_64                                    </span><br><span class="line">  bind-32:9.11.4-17.P2.el8_0.1.x86_64                                           </span><br><span class="line"></span><br><span class="line">완료되었습니다!</span><br></pre></td></tr></table></figure>

<br>


<h3 id="etc-named-conf에서-4개의-줄-편집"><a href="#etc-named-conf에서-4개의-줄-편집" class="headerlink" title="/etc/named.conf에서 4개의 줄 편집"></a>/etc/named.conf에서 4개의 줄 편집</h3><ol>
<li>listen-on port 53 { any; };</li>
<li>listen-on-v6 port 53 { none; };</li>
<li>allow-query     { any; };</li>
<li>dnssec-validation no;</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">[root@192 ~]# vi /etc/named.conf</span><br><span class="line">[root@192 ~]# cat /etc/named.conf</span><br><span class="line">//</span><br><span class="line">// named.conf</span><br><span class="line">//</span><br><span class="line">// Provided by Red Hat bind package to configure the ISC BIND named(8) DNS</span><br><span class="line">// server as a caching only nameserver (as a localhost DNS resolver only).</span><br><span class="line">//</span><br><span class="line">// See /usr/share/doc/bind*/sample/ for example named configuration files.</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">options &#123;</span><br><span class="line">	listen-on port 53 &#123; any; &#125;;</span><br><span class="line">	listen-on-v6 port 53 &#123; none; &#125;;</span><br><span class="line">	directory 	&quot;/var/named&quot;;</span><br><span class="line">	dump-file 	&quot;/var/named/data/cache_dump.db&quot;;</span><br><span class="line">	statistics-file &quot;/var/named/data/named_stats.txt&quot;;</span><br><span class="line">	memstatistics-file &quot;/var/named/data/named_mem_stats.txt&quot;;</span><br><span class="line">	secroots-file	&quot;/var/named/data/named.secroots&quot;;</span><br><span class="line">	recursing-file	&quot;/var/named/data/named.recursing&quot;;</span><br><span class="line">	allow-query     &#123; any; &#125;;</span><br><span class="line"></span><br><span class="line">	/* </span><br><span class="line">	 - If you are building an AUTHORITATIVE DNS server, do NOT enable recursion.</span><br><span class="line">	 - If you are building a RECURSIVE (caching) DNS server, you need to enable </span><br><span class="line">	   recursion. </span><br><span class="line">	 - If your recursive DNS server has a public IP address, you MUST enable access </span><br><span class="line">	   control to limit queries to your legitimate users. Failing to do so will</span><br><span class="line">	   cause your server to become part of large scale DNS amplification </span><br><span class="line">	   attacks. Implementing BCP38 within your network would greatly</span><br><span class="line">	   reduce such attack surface </span><br><span class="line">	*/</span><br><span class="line">	recursion yes;</span><br><span class="line"></span><br><span class="line">	dnssec-enable yes;</span><br><span class="line">	dnssec-validation no;</span><br><span class="line"></span><br><span class="line">	managed-keys-directory &quot;/var/named/dynamic&quot;;</span><br><span class="line"></span><br><span class="line">	pid-file &quot;/run/named/named.pid&quot;;</span><br><span class="line">	session-keyfile &quot;/run/named/session.key&quot;;</span><br><span class="line"></span><br><span class="line">	/* https://fedoraproject.org/wiki/Changes/CryptoPolicy */</span><br><span class="line">	include &quot;/etc/crypto-policies/back-ends/bind.config&quot;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">logging &#123;</span><br><span class="line">        channel default_debug &#123;</span><br><span class="line">                file &quot;data/named.run&quot;;</span><br><span class="line">                severity dynamic;</span><br><span class="line">        &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">zone &quot;.&quot; IN &#123;</span><br><span class="line">	type hint;</span><br><span class="line">	file &quot;named.ca&quot;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">include &quot;/etc/named.rfc1912.zones&quot;;</span><br><span class="line">include &quot;/etc/named.root.key&quot;;</span><br></pre></td></tr></table></figure>

<br>

<h3 id="named-서버-다시-시작-항상-가동-status-확인"><a href="#named-서버-다시-시작-항상-가동-status-확인" class="headerlink" title="named 서버 다시 시작, 항상 가동, status 확인"></a>named 서버 다시 시작, 항상 가동, status 확인</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[root@192 ~]# systemctl restart named</span><br><span class="line">[root@192 ~]# systemctl enable named</span><br><span class="line">Created symlink /etc/systemd/system/multi-user.target.wants/named.service → /usr/lib/systemd/system/named.service.</span><br><span class="line">[root@192 ~]# systemctl status named</span><br><span class="line">● named.service - Berkeley Internet Name Domain (DNS)</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/named.service; enabled; vendor prese&gt;</span><br><span class="line">   Active: active (running) since Sun 2020-06-07 20:33:59 KST; 15s ago</span><br><span class="line"> Main PID: 3545 (named)</span><br><span class="line">    Tasks: 4 (limit: 11376)</span><br><span class="line">   Memory: 56.0M</span><br><span class="line">   CGroup: /system.slice/named.service</span><br><span class="line">           └─3545 /usr/sbin/named -u named -c /etc/named.conf</span><br><span class="line"></span><br><span class="line"> 6월 07 20:33:59 192.168.nate.com named[3545]: network unreachable resolving &apos;.&gt;</span><br><span class="line"> 6월 07 20:33:59 192.168.nate.com named[3545]: network unreachable resolving &apos;.&gt;</span><br><span class="line"> 6월 07 20:33:59 192.168.nate.com named[3545]: network unreachable resolving &apos;.&gt;</span><br><span class="line"> 6월 07 20:33:59 192.168.nate.com named[3545]: network unreachable resolving &apos;.&gt;</span><br><span class="line"> 6월 07 20:33:59 192.168.nate.com named[3545]: network unreachable resolving &apos;.&gt;</span><br><span class="line"> 6월 07 20:33:59 192.168.nate.com named[3545]: network unreachable resolving &apos;.&gt;</span><br><span class="line"> 6월 07 20:33:59 192.168.nate.com named[3545]: network unreachable resolving &apos;.&gt;</span><br><span class="line"> 6월 07 20:33:59 192.168.nate.com named[3545]: network unreachable resolving &apos;.&gt;</span><br><span class="line"> 6월 07 20:34:00 192.168.nate.com named[3545]: managed-keys-zone: Key 20326 for&gt;</span><br><span class="line"> 6월 07 20:34:00 192.168.nate.com named[3545]: resolver priming query complete</span><br><span class="line">lines 1-19/19 (END)</span><br></pre></td></tr></table></figure>

<br>

<h3 id="이제-192-168-111-100-서버가-캐싱서버로-설정이-되었다-방화벽-열어주어-클라이언트가-접근할-수-있도록-해주자"><a href="#이제-192-168-111-100-서버가-캐싱서버로-설정이-되었다-방화벽-열어주어-클라이언트가-접근할-수-있도록-해주자" class="headerlink" title="이제 192.168.111.100 서버가 캐싱서버로 설정이 되었다. 방화벽 열어주어 클라이언트가 접근할 수 있도록 해주자."></a>이제 192.168.111.100 서버가 캐싱서버로 설정이 되었다. 방화벽 열어주어 클라이언트가 접근할 수 있도록 해주자.</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@192 ~]# firewall-config</span><br><span class="line">&gt;&gt; 영구적 &gt;&gt; 서비스 탭에서 dns 체크 &gt;&gt; 옵션 &gt;&gt; firewalld 다시 불러오기 통해서 저장 &gt;&gt; 완료!</span><br></pre></td></tr></table></figure>

<br>

<h3 id="서버-내에서-테스트"><a href="#서버-내에서-테스트" class="headerlink" title="서버 내에서 테스트"></a>서버 내에서 테스트</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">[root@192 ~]# dig @192.168.111.100 www.google.com</span><br><span class="line"></span><br><span class="line">; &lt;&lt;&gt;&gt; DiG 9.11.4-P2-RedHat-9.11.4-17.P2.el8_0.1 &lt;&lt;&gt;&gt; @192.168.111.100 www.google.com</span><br><span class="line">; (1 server found)</span><br><span class="line">;; global options: +cmd</span><br><span class="line">;; Got answer:</span><br><span class="line">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 47167</span><br><span class="line">;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 4, ADDITIONAL: 9</span><br><span class="line"></span><br><span class="line">;; OPT PSEUDOSECTION:</span><br><span class="line">; EDNS: version: 0, flags:; udp: 4096</span><br><span class="line">; COOKIE: 0837668b4e8b28d1405eb8925edcd25404a3e8596273ed40 (good)</span><br><span class="line">;; QUESTION SECTION:</span><br><span class="line">;www.google.com.			IN	A</span><br><span class="line"></span><br><span class="line">;; ANSWER SECTION:</span><br><span class="line">www.google.com.		300	IN	A	172.217.31.164</span><br><span class="line"></span><br><span class="line">;; AUTHORITY SECTION:</span><br><span class="line">google.com.		172800	IN	NS	ns4.google.com.</span><br><span class="line">google.com.		172800	IN	NS	ns1.google.com.</span><br><span class="line">google.com.		172800	IN	NS	ns2.google.com.</span><br><span class="line">google.com.		172800	IN	NS	ns3.google.com.</span><br><span class="line"></span><br><span class="line">;; ADDITIONAL SECTION:</span><br><span class="line">ns2.google.com.		172800	IN	A	216.239.34.10</span><br><span class="line">ns1.google.com.		172800	IN	A	216.239.32.10</span><br><span class="line">ns3.google.com.		172800	IN	A	216.239.36.10</span><br><span class="line">ns4.google.com.		172800	IN	A	216.239.38.10</span><br><span class="line">ns2.google.com.		172800	IN	AAAA	2001:4860:4802:34::a</span><br><span class="line">ns1.google.com.		172800	IN	AAAA	2001:4860:4802:32::a</span><br><span class="line">ns3.google.com.		172800	IN	AAAA	2001:4860:4802:36::a</span><br><span class="line">ns4.google.com.		172800	IN	AAAA	2001:4860:4802:38::a</span><br><span class="line"></span><br><span class="line">;; Query time: 866 msec</span><br><span class="line">;; SERVER: 192.168.111.100#53(192.168.111.100)</span><br><span class="line">;; WHEN: 일  6월 07 20:41:08 KST 2020</span><br><span class="line">;; MSG SIZE  rcvd: 335</span><br></pre></td></tr></table></figure>

<br>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@192 ~]# nslookup</span><br><span class="line">&gt; server</span><br><span class="line">Default server: 192.168.111.2</span><br><span class="line">Address: 192.168.111.2#53</span><br><span class="line"></span><br><span class="line">&gt; server 192.168.111.100</span><br><span class="line">Default server: 192.168.111.100</span><br><span class="line">Address: 192.168.111.100#53</span><br><span class="line"></span><br><span class="line">&gt; www.google.com</span><br><span class="line">Server:		192.168.111.100</span><br><span class="line">Address:	192.168.111.100#53</span><br><span class="line"></span><br><span class="line">Non-authoritative answer:</span><br><span class="line">Name:	www.google.com</span><br><span class="line">Address: 172.217.31.164</span><br><span class="line">Name:	www.google.com</span><br><span class="line">Address: 2404:6800:4004:80c::2004</span><br></pre></td></tr></table></figure>

<br>

<h3 id="외부-클라이언트에서-확인하기"><a href="#외부-클라이언트에서-확인하기" class="headerlink" title="외부 클라이언트에서 확인하기"></a>외부 클라이언트에서 확인하기</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[centos@192 ~]$ nslookup</span><br><span class="line">&gt; server</span><br><span class="line">Default server: 192.168.111.2</span><br><span class="line">Address: 192.168.111.2#53</span><br><span class="line"></span><br><span class="line">&gt; server 192.168.111.100</span><br><span class="line">Default server: 192.168.111.100</span><br><span class="line">Address: 192.168.111.100#53</span><br><span class="line"></span><br><span class="line">&gt; www.google.com</span><br><span class="line">Server:		192.168.111.100</span><br><span class="line">Address:	192.168.111.100#53</span><br><span class="line"></span><br><span class="line">Non-authoritative answer:</span><br><span class="line">Name:	www.google.com</span><br><span class="line">Address: 172.217.31.164</span><br><span class="line">Name:	www.google.com</span><br><span class="line">Address: 2404:6800:4004:80c::2004</span><br><span class="line"></span><br><span class="line">&gt; www.hanbit.co.kr</span><br><span class="line">Server:		192.168.111.100</span><br><span class="line">Address:	192.168.111.100#53</span><br><span class="line"></span><br><span class="line">Non-authoritative answer:</span><br><span class="line">Name:	www.hanbit.co.kr</span><br><span class="line">Address: 218.38.58.195</span><br></pre></td></tr></table></figure>

<br>

<h3 id="영구적으로-캐싱서버를-네임서버로-지정하기"><a href="#영구적으로-캐싱서버를-네임서버로-지정하기" class="headerlink" title="영구적으로 캐싱서버를 네임서버로 지정하기"></a>영구적으로 캐싱서버를 네임서버로 지정하기</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">[centos@192 ~]$ su -c &apos;gedit /etc/resolv.conf&apos;</span><br><span class="line">암호:</span><br><span class="line">No protocol specified</span><br><span class="line"></span><br><span class="line">(gedit:8410): dbind-WARNING **: 20:53:12.023: Could not open X display</span><br><span class="line"></span><br><span class="line">(gedit:8410): GLib-GIO-CRITICAL **: 20:53:12.046: g_dbus_proxy_new_sync: assertion &apos;G_IS_DBUS_CONNECTION (connection)&apos; failed</span><br><span class="line"></span><br><span class="line">(gedit:8410): dconf-WARNING **: 20:53:12.095: failed to commit changes to dconf: 연결이 닫혔습니다</span><br><span class="line"></span><br><span class="line">(gedit:8410): dconf-WARNING **: 20:53:12.095: failed to commit changes to dconf: 연결이 닫혔습니다</span><br><span class="line">Error creating proxy: 연결이 닫혔습니다 (g-io-error-quark, 18)</span><br><span class="line">Error creating proxy: 연결이 닫혔습니다 (g-io-error-quark, 18)</span><br><span class="line">Error creating proxy: 연결이 닫혔습니다 (g-io-error-quark, 18)</span><br><span class="line">Error creating proxy: 연결이 닫혔습니다 (g-io-error-quark, 18)</span><br><span class="line">Error creating proxy: 연결이 닫혔습니다 (g-io-error-quark, 18)</span><br><span class="line"></span><br><span class="line">(gedit:8410): dconf-WARNING **: 20:53:13.445: failed to commit changes to dconf: 연결이 닫혔습니다</span><br><span class="line"></span><br><span class="line">(gedit:8410): dconf-WARNING **: 20:53:13.448: failed to commit changes to dconf: 연결이 닫혔습니다</span><br><span class="line"></span><br><span class="line">(gedit:8410): dconf-WARNING **: 20:53:13.448: failed to commit changes to dconf: 연결이 닫혔습니다</span><br><span class="line"></span><br><span class="line">** (gedit:8410): WARNING **: 20:53:16.460: Set document metadata failed: metadata::gedit-position 속성 설정은 지원하지 않습니다</span><br><span class="line"></span><br><span class="line">(gedit:8410): dconf-WARNING **: 20:53:16.910: failed to commit changes to dconf: 연결이 닫혔습니다</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[centos@192 ~]$ su -c &apos;cat /etc/resolv.conf&apos;</span><br><span class="line">암호:</span><br><span class="line"># Generated by NetworkManager</span><br><span class="line">search localdomain 168.nate.com</span><br><span class="line">nameserver 192.168.111.100</span><br><span class="line">[centos@192 ~]$</span><br></pre></td></tr></table></figure>

<p>서버 B, windows client도 동일하게 진행해준다.</p>
<p><em>참고</em></p>
<ul>
<li>터미널모드에서 웹브라우저 접속하기 <ul>
<li>dnf -y install elinks</li>
<li>elinks</li>
<li>빠져나오기 : esc + exit</li>
</ul>
</li>
</ul>
<p><br><br></p>

                    
                    <!-- Tags Bottom -->
                    
                        <div class="tags-container-bottom">
                            <i class="fa fa-tag pr3 text-main-color"></i><a class="fw3 ph1 dib" href="/tags/linux/">#linux</a>
                        </div>
                    

                    <!-- Comments -->
                    
<div id="disqus_thread" class="mt5">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>




                </div>
                <div class="fl w-100 w-30-l center fw3 lh-copy pl4-ns tl black-50">
                    
                    <hr class="dn-l mw4 black-50 mt5" />
                    
                    <!-- Widget 1: About -->
                    <div class="mt5 mt0-l">
    <article class="dt db-l mw8 mw8-m mw5-ns center ml0-l bg-white mv3">
        <div class="dn dtc-m db-l v-mid tc pr4 pr0-l" style="min-width: 6rem;">
            <img src="https://img1.daumcdn.net/thumb/C500x500/?fname=http://t1.daumcdn.net/brunch/service/user/22GJ/image/yRk2mTiHwL4iKOXVcxuRUGKpOXA.jpg" class="mb4-l br-100 h3 w3 h4-l w4-l dib" title="Kabarnet">
        </div>
        <div class="dtc db-l v-mid lh-copy measure center f6 black-50 tj">
            어제는 케냐에서 NGO 사업관리를 하다가 오늘은 개발을 배우고 있는 카바넷입니다. 기술을 통해 변화할 사회에 많은 관심을 가지고 있습니다. 
        </div>
    </article>
</div>

                    <hr class="dn-l mw4 black-50 mt5" />
                    
                    <!-- Widget 2: Categories -->
                    

                    <!-- Widget 3: Recent Posts -->
                    <div class="mt5 tc tl-l">
    <h3>Recent Posts</h3>
    
        <p>
            <a href="/2020/06/07/linux-thisislinux26/">이것이 리눅스다(2020) 26 / 네임 서버 - IP획득과정, DNS개념, 캐싱전용네임서</a>
        </p>
    
        <p>
            <a href="/2020/06/07/linux-thisislinux25/">이것이 리눅스다(2020) 25 / 네임 서버 - 네임서버 개념과 hosts 파일 역할</a>
        </p>
    
        <p>
            <a href="/2020/06/07/linux-thisislinux24/">이것이 리눅스다(2020) 24 / 원격지 시스템 관리 - XRDP 서버</a>
        </p>
    
        <p>
            <a href="/2020/06/07/linux-thisislinux23/">이것이 리눅스다(2020) 23 / 원격지 시스템 관리 - SSH 서버</a>
        </p>
    
        <p>
            <a href="/2020/06/07/linux-thisislinux22/">이것이 리눅스다(2020) 22 / 원격지 시스템 관리 - 텔넷 서버</a>
        </p>
    
</div>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- Footer -->
<div class="bg-1 ph2 ph5-ns pv5">
        <div class="mv8">
            <div class="center tc">
                
                    <div class="dib mh3">
                        <a class="f3 f2-ns white dim" href="https://github.com/Miniminis" target="_blank">
                            <i class="fa fa-github"></i>
                        </a>
                    </div>
                
                    <div class="dib mh3">
                        <a class="f3 f2-ns white dim" href="mailto:minhee4735@gmail.com" target="_blank">
                            <i class="fa fa-envelope"></i>
                        </a>
                    </div>
                
                    <div class="dib mh3">
                        <a class="f3 f2-ns white dim" href="/rss2.xml" target="_blank">
                            <i class="fa fa-rss"></i>
                        </a>
                    </div>
                
                    <div class="dib mh3">
                        <a class="f3 f2-ns white dim" href="https://brunch.co.kr/@miniblackgoat" target="_blank">
                            <i class="fa fa-edit"></i>
                        </a>
                    </div>
                
            </div>
            <div class="f6 f5-ns center tc white pt5 fw3">
                All right reserved @Kabarnet. | Design & Hexo <a class="link dim white" href="http://www.codeblocq.com/">Jonathan Klughertz</a>
            </div>
        </div>
    </div>

<!-- After Footer -->
<!-- Disqus Comments -->

<script type="text/javascript">
    var disqus_shortname = 'miniminis-github-io-2';

    (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



</body>

</html>